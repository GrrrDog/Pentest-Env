import base64
import sys, os
import urllib.parse
import html
import json
import codecs


env = os.environ

def write_result(res):
    with open(env['TEMP']+'\\tmp_out.txt', 'w',  encoding="utf-8") as tmp_out:
        tmp_out.write(res)

def read_result():
    with open(env['TEMP']+'\\tmp_in.txt', 'r') as tmp_file:
        return tmp_file.read() 

def html_entities(string):
    return html.escape(string)
    

def html_ord(string):
    return ''.join(['&#{0};'.format(ord(char)) for char in string])

def html_char(string):
    return html.unescape(string)  

def escape_spec(string):
   return string.replace('\\', '\\\\').replace("'", "\\'").replace('"', '\\"')
     
def unescape_spec(string):
   return string.replace('\\\\', '\\').replace( "\\'","'").replace('\\"', '"')

def unicode_hex(string):
    # return ''.join(['&#{0};'.format(hex(ord(char))[2:]) for char in string])
    return ''.join(['\\u00{:02x}'.format(ord(char)) for char in string])
    
def unicode_decode(string):
    return codecs.decode(string, 'unicode-escape')
    

content = read_result()

if sys.argv[1]=="b64enc":
    new_str = base64.b64encode(content.encode('utf-8'))
    # print(new_str.decode('utf-8'),end="")
    new_str=new_str.decode('utf-8')
    
elif sys.argv[1]=="b64dec":
    new_str = base64.b64decode(content.encode('utf-8'))
    # print(new_str.decode('utf-8'),end="")
    new_str=new_str.decode('utf-8')

elif sys.argv[1]=="urlenc":
    new_str = urllib.parse.quote(content.encode('utf-8'), safe='')
    print(new_str,end="")
elif sys.argv[1]=="urldec":
    new_str = urllib.parse.unquote(content)
    print(new_str,end="")
    
elif sys.argv[1]=="htmlentenc":
    new_str = html_entities(content)
    print(new_str,end="")
elif sys.argv[1]=="htmlenc":
    new_str = html_ord(content)
    print(new_str,end="")
elif sys.argv[1]=="htmldec":
    new_str = html_char(content)
    print(new_str,end="")
    
elif sys.argv[1]=="unienc":
    new_str = unicode_hex(content)
    print(new_str,end="")
elif sys.argv[1]=="unidec":
    new_str = unicode_decode(content)
    print(new_str,end="")

elif sys.argv[1]=="escspec":
    new_str = escape_spec(content)
    print(new_str,end="")
elif sys.argv[1]=="unescspec":
    new_str = unescape_spec(content)
    print(new_str,end="")


write_result(new_str)
